---
marp: true
theme: default
paginate: true
style: |
  section {
    font-family: 'Hiragino Kaku Gothic ProN', 'Meiryo', sans-serif;
    font-size: 28px;
  }
  h1 {
    font-size: 48px;
    color: #2c3e50;
    border-bottom: 3px solid #3498db;
    padding-bottom: 10px;
  }
  h2 {
    font-size: 38px;
    color: #2980b9;
  }
  .highlight {
    background: #ffeaa7;
    padding: 4px 8px;
    border-radius: 4px;
  }
  code {
    background: #f0f0f0;
    padding: 2px 6px;
    border-radius: 3px;
    font-size: 0.85em;
  }
  pre code {
    font-size: 0.75em;
  }
  .meta {
    color: #7f8c8d;
    font-size: 0.8em;
    margin-top: 40px;
  }
---

# TIL始めました

### 〜そしてそのスライドをAIに作ってもらいました〜

<br>

2026/02/21

---

# 自己紹介 & 今日の話

**今日話すこと**

1. TIL（Today I Learned）を最近始めた
2. せっかくなのでスライドもAIに作ってもらった
3. AIが選んだ「最近のTIL」をいくつか紹介する

<br>

> ※ このスライドは Claude Code に作ってもらいました

---

# TIL（Today I Learned）とは

- その日学んだことを毎日記録していく習慣・リポジトリ
- GitHubのMarkdownファイルで管理する人が多い
- エンジニアの間で昔からある文化

```
til/
└── 2026/
    └── 2026-02/
        ├── 2026-02-19.md
        ├── 2026-02-20.md
        └── 2026-02-21.md
```

---

# なぜ始めたか

- 毎日何かしら学んでいるのに、忘れてしまう
- 「今日何を学んだっけ？」が答えられない
- 記録することで **学びを定着させる** + **振り返れる**

**ルール（自分で決めた）**

- 技術・仕事・なんでもOK
- しょうもないことでもOK
- 業務情報・機密情報はNG
- 業務特有の話は汎化して書く

---

# でも、スライドは面倒くさい

実はTILを始めて3日目に、こんなことを書いていた 👇

<br>

> **2026-02-20 のTIL**
>
> このリポジトリの記録がたまってきたら、
> AIに読ませてスライドも喋る内容も全部AIに考えてもらうというのも面白いかもしれない

<br>

→ **記録して翌日には実行してみた**

---

# AIにスライドを作ってもらった結果

**やったこと**

- TILリポジトリをClaudeに渡す
- 「7分のプレゼン資料を作って」と依頼
- 構成・内容・スライド全部おまかせ

**AIが選んだネタ**（これから紹介します）

1. Express v5 の破壊的変更でハマった話
2. レイヤードアーキテクチャの責任分離
3. CloudFormation のロールバック地獄

---

# TIL① Express v5 でデプロイが落ちた

**何が起きたか**

- Lambda + Express の構成でデプロイが失敗
- CloudFormationが `UPDATE_ROLLBACK_FAILED` に

**原因を調べると…**

- Provisioned Concurrencyのバージョン作成時にLambdaのコードが起動
- その時点でExpressが **クラッシュ** していた

**さらに掘り下げると…**

---

# TIL① Express v5 でデプロイが落ちた（続き）

**根本原因：ルートパスに `?` を書いていた**

```typescript
// NG: クエリパラメータをパスに含めてしまっていた
app.get("/items?id=123", handler);
```

Express v5 から `?` がルートパスで使えなくなった

**なぜ？**

Express はルートマッチングに `path-to-regexp` を使用。
v5 から `?` は別の意味（optional segment）になり、
クエリ文字列風の書き方はエラーになる。

---

# TIL① Express v5 の正しい書き方

**そもそも `?` はパスの一部ではない**

> Query strings are not part of the route path.
> — Express 公式ドキュメント

```typescript
// OK: クエリパラメータはパスに含めない
app.get("/items", (req, res) => {
  const id = req.query.id; // ← こっちで取る
  res.send(`id: ${id}`);
});
```

**教訓**：v4 → v5 の移行時は破壊的変更に要注意！

---

# TIL② レイヤードアーキテクチャの責任分離

| 層               | 責任                                 |
| ---------------- | ------------------------------------ |
| **ハンドラー層** | HTTPリクエストの検証・レスポンス返却 |
| **サービス層**   | ビジネスロジック                     |
| **インフラ層**   | データの永続化（DB操作など）         |

**ポイント**

- 各層が「何に責任を持つか」を明確にする
- サービス層にHTTPの知識を持ち込まない
- インフラ層にビジネスロジックを書かない

→ 責任分離することで **保守性・テスト容易性** が上がる

---

# TIL③ CloudFormation のロールバック地獄

**`UPDATE_ROLLBACK_FAILED` になったとき**

1. コンソールから「**更新ロールバックを続ける**」を実行
2. それでもエラーなら「**高度なオプション**」でリソースをスキップ
3. とにかく `UPDATE_ROLLBACK_COMPLETE` の状態にもっていく

**今回の原因**

- Express のクラッシュ（①の話）で Lambda の Provisioned Concurrency 設定が失敗
- デプロイ失敗 → ロールバックも失敗 → 地獄

---

# おまけのTIL

**VS Code**

- Markdownの保存時整形は Prettier が一番使い勝手がよい
  - `"editor.formatOnSave": true` + `esbenp.prettier-vscode`

**Linux**

- `stat ファイル名` でファイルの作成・更新時刻を確認できる

**Terraform**

- 発音は `te` にアクセント（テラフォーム）
- 裏でAWSなどのAPIを呼んで冪等な操作を実現するもの

**統計**

- `E(X)` はμ（expected value / mean）を表す表記

---

# まとめ

**TILを始めて3日間でやったこと**

- 毎日の学びをMarkdownに記録
- Gitで管理してGitHubに push

**AIに作ってもらったスライド**

- ネタ選びから構成・文章まで全部おまかせ
- 意外とちゃんとしたものができた

<br>

**TIL、おすすめです。記録が溜まればAIがスライドを作ってくれます。**

---

# ご清聴ありがとうございました

<br>

**このTILリポジトリ**

```
til/
├── README.md     ← ルール書いてある
└── 2026/
    └── 2026-02/
        ├── 2026-02-19.md
        ├── 2026-02-20.md
        └── 2026-02-21.md   ← 今日のやつ
```

<br>

<div class="meta">スライド作成：Claude Code (claude-sonnet-4-6) / 2026-02-21</div>

## プロンプト

```
このリポジトリは私のTILをまとめたものです。この内容をもとに、7分程度のプレゼンの内容とスライドを作成してください。構成としては、TILを最近始めたのでそのスライドをAIに作ってもらいました。というのと、その作ってもらったスライドという内容です。どの内容にするかはお任せします
```
